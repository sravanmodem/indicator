{% if error %}
<div class="glass rounded-2xl h-[80px] flex items-center px-3 bg-gradient-to-br from-surface-800/90 to-surface-900/90 border border-slate-700/50 shadow-lg">
    <div class="flex items-center w-full gap-2">
        {% for i in range(7) %}
        <div class="flex-1 h-[60px] rounded-xl bg-surface-900/80 border border-slate-700/30 flex flex-col items-center justify-center backdrop-blur">
            <span class="text-[8px] text-slate-500 uppercase tracking-wider">--</span>
            <span class="text-slate-600 font-mono font-bold text-sm">--</span>
            <span class="text-[8px] text-slate-600">--</span>
        </div>
        {% endfor %}
    </div>
</div>
{% elif indicators %}
<div class="glass rounded-2xl h-[80px] flex items-center px-3 bg-gradient-to-br from-surface-800/90 to-surface-900/90 border border-slate-700/50 shadow-lg">
    <div class="flex items-center w-full gap-2">
        <!-- SuperTrend -->
        <div class="flex-1 h-[60px] rounded-xl border backdrop-blur flex flex-col items-center justify-center {% if indicators.supertrend.direction.iloc[-1] == 1 %}bg-gradient-to-b from-green-500/20 to-green-500/5 border-green-500/40{% else %}bg-gradient-to-b from-red-500/20 to-red-500/5 border-red-500/40{% endif %}">
            <span class="text-[8px] text-slate-400 uppercase tracking-wider">SuperTrend</span>
            <span class="{% if indicators.supertrend.direction.iloc[-1] == 1 %}text-green-400{% else %}text-red-400{% endif %} font-mono font-bold text-sm">{{ "%.0f"|format(indicators.supertrend.supertrend.iloc[-1]) }}</span>
            <span class="px-1.5 py-0.5 rounded text-[8px] font-bold {% if indicators.supertrend.direction.iloc[-1] == 1 %}bg-green-500/30 text-green-300{% else %}bg-red-500/30 text-red-300{% endif %}">{% if indicators.supertrend.direction.iloc[-1] == 1 %}BUY{% else %}SELL{% endif %}</span>
        </div>

        <!-- EMA -->
        <div class="flex-1 h-[60px] rounded-xl border backdrop-blur flex flex-col items-center justify-center {% if indicators.ema.ema_fast.iloc[-1] > indicators.ema.ema_slow.iloc[-1] %}bg-gradient-to-b from-green-500/20 to-green-500/5 border-green-500/40{% else %}bg-gradient-to-b from-red-500/20 to-red-500/5 border-red-500/40{% endif %}">
            <span class="text-[8px] text-slate-400 uppercase tracking-wider">EMA</span>
            <span class="text-white font-mono font-bold text-sm">{{ "%.0f"|format(indicators.ema.ema_fast.iloc[-1]) }}</span>
            <span class="px-1.5 py-0.5 rounded text-[8px] font-bold {% if indicators.ema.ema_fast.iloc[-1] > indicators.ema.ema_slow.iloc[-1] %}bg-green-500/30 text-green-300{% else %}bg-red-500/30 text-red-300{% endif %}">{% if indicators.ema.ema_fast.iloc[-1] > indicators.ema.ema_slow.iloc[-1] %}UP{% else %}DOWN{% endif %}</span>
        </div>

        <!-- ADX -->
        <div class="flex-1 h-[60px] rounded-xl border backdrop-blur flex flex-col items-center justify-center {% if indicators.adx.adx.iloc[-1] > 25 %}bg-gradient-to-b from-green-500/20 to-green-500/5 border-green-500/40{% else %}bg-gradient-to-b from-yellow-500/20 to-yellow-500/5 border-yellow-500/40{% endif %}">
            <span class="text-[8px] text-slate-400 uppercase tracking-wider">ADX</span>
            <span class="text-white font-mono font-bold text-sm">{{ "%.0f"|format(indicators.adx.adx.iloc[-1]) }}</span>
            <span class="px-1.5 py-0.5 rounded text-[8px] font-bold {% if indicators.adx.adx.iloc[-1] > 25 %}bg-green-500/30 text-green-300{% else %}bg-yellow-500/30 text-yellow-300{% endif %}">{% if indicators.adx.adx.iloc[-1] > 25 %}STRONG{% else %}WEAK{% endif %}</span>
        </div>

        <!-- RSI -->
        <div class="flex-1 h-[60px] rounded-xl border backdrop-blur flex flex-col items-center justify-center {% if indicators.rsi.rsi.iloc[-1] > 70 %}bg-gradient-to-b from-red-500/20 to-red-500/5 border-red-500/40{% elif indicators.rsi.rsi.iloc[-1] < 30 %}bg-gradient-to-b from-green-500/20 to-green-500/5 border-green-500/40{% else %}bg-gradient-to-b from-slate-500/20 to-slate-500/5 border-slate-500/40{% endif %}">
            <span class="text-[8px] text-slate-400 uppercase tracking-wider">RSI</span>
            <span class="text-white font-mono font-bold text-sm">{{ "%.0f"|format(indicators.rsi.rsi.iloc[-1]) }}</span>
            <span class="px-1.5 py-0.5 rounded text-[8px] font-bold {% if indicators.rsi.rsi.iloc[-1] > 70 %}bg-red-500/30 text-red-300{% elif indicators.rsi.rsi.iloc[-1] < 30 %}bg-green-500/30 text-green-300{% elif indicators.rsi.rsi.iloc[-1] > 50 %}bg-green-500/30 text-green-300{% else %}bg-red-500/30 text-red-300{% endif %}">{% if indicators.rsi.rsi.iloc[-1] > 70 %}OB{% elif indicators.rsi.rsi.iloc[-1] < 30 %}OS{% elif indicators.rsi.rsi.iloc[-1] > 50 %}BULL{% else %}BEAR{% endif %}</span>
        </div>

        <!-- MACD -->
        <div class="flex-1 h-[60px] rounded-xl border backdrop-blur flex flex-col items-center justify-center {% if indicators.macd.histogram.iloc[-1] > 0 %}bg-gradient-to-b from-green-500/20 to-green-500/5 border-green-500/40{% else %}bg-gradient-to-b from-red-500/20 to-red-500/5 border-red-500/40{% endif %}">
            <span class="text-[8px] text-slate-400 uppercase tracking-wider">MACD</span>
            <span class="{% if indicators.macd.histogram.iloc[-1] > 0 %}text-green-400{% else %}text-red-400{% endif %} font-mono font-bold text-sm">{{ "%.0f"|format(indicators.macd.histogram.iloc[-1]) }}</span>
            <span class="px-1.5 py-0.5 rounded text-[8px] font-bold {% if indicators.macd.histogram.iloc[-1] > 0 %}bg-green-500/30 text-green-300{% else %}bg-red-500/30 text-red-300{% endif %}">{% if indicators.macd.histogram.iloc[-1] > 0 %}BULL{% else %}BEAR{% endif %}</span>
        </div>

        <!-- ATR -->
        <div class="flex-1 h-[60px] rounded-xl border backdrop-blur flex flex-col items-center justify-center bg-gradient-to-b from-blue-500/20 to-blue-500/5 border-blue-500/40">
            <span class="text-[8px] text-slate-400 uppercase tracking-wider">ATR</span>
            <span class="text-white font-mono font-bold text-sm">{{ "%.0f"|format(indicators.atr.atr.iloc[-1]) }}</span>
            <span class="px-1.5 py-0.5 rounded text-[8px] font-bold bg-blue-500/30 text-blue-300">{{ indicators.atr.volatility_state.iloc[-1][:3] | upper }}</span>
        </div>

        <!-- Trend Summary / BIAS -->
        {% set bullish_count = 0 %}
        {% if indicators.supertrend.direction.iloc[-1] == 1 %}{% set bullish_count = bullish_count + 1 %}{% endif %}
        {% if indicators.ema.ema_fast.iloc[-1] > indicators.ema.ema_slow.iloc[-1] %}{% set bullish_count = bullish_count + 1 %}{% endif %}
        {% if indicators.rsi.rsi.iloc[-1] > 50 %}{% set bullish_count = bullish_count + 1 %}{% endif %}
        {% if indicators.macd.histogram.iloc[-1] > 0 %}{% set bullish_count = bullish_count + 1 %}{% endif %}
        <div class="flex-1 h-[60px] rounded-xl border backdrop-blur flex flex-col items-center justify-center {% if bullish_count >= 3 %}bg-gradient-to-b from-green-500/30 to-green-500/10 border-green-500/50 shadow-lg shadow-green-500/20{% elif bullish_count <= 1 %}bg-gradient-to-b from-red-500/30 to-red-500/10 border-red-500/50 shadow-lg shadow-red-500/20{% else %}bg-gradient-to-b from-yellow-500/30 to-yellow-500/10 border-yellow-500/50 shadow-lg shadow-yellow-500/20{% endif %}">
            <span class="text-[8px] text-slate-400 uppercase tracking-wider">BIAS</span>
            <span class="font-black text-lg {% if bullish_count >= 3 %}text-green-400{% elif bullish_count <= 1 %}text-red-400{% else %}text-yellow-400{% endif %}">{% if bullish_count >= 3 %}CE{% elif bullish_count <= 1 %}PE{% else %}--{% endif %}</span>
            <span class="text-[9px] font-bold {% if bullish_count >= 3 %}text-green-400{% elif bullish_count <= 1 %}text-red-400{% else %}text-yellow-400{% endif %}">{{ bullish_count }}/4</span>
        </div>
    </div>
</div>
{% else %}
<div class="glass rounded-2xl h-[80px] flex items-center justify-center bg-gradient-to-br from-surface-800/90 to-surface-900/90 border border-slate-700/50">
    <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-slate-700/50 flex items-center justify-center">
            <svg class="w-4 h-4 text-slate-400 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
            </svg>
        </div>
        <p class="text-slate-400 text-sm font-medium">Loading indicators...</p>
    </div>
</div>
{% endif %}
